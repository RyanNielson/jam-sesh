<script type="text/javascript">
  var buffers = new Object();
  var pusher = new Pusher('cb0d48e70b7bd9b4c14c');
  var channel = pusher.subscribe('notes');
  channel.bind('note_played', function(data) {
    playSound(buffers[data.instrument + "_" + data.note]);
  });

  window.onload = init;
  var context;
  var bufferLoader;

  function init() {
    window.AudioContext = window.AudioContext || window.webkitAudioContext;
    context = new AudioContext();

    bufferLoader = new BufferLoader(
      context,
      {
        drum_0: "/sounds/drum/0.mp3",
        drum_1: "/sounds/drum/1.mp3",
        guitar_0: "/sounds/guitar/0.mp3",
        guitar_1: "/sounds/guitar/1.mp3"
      },
      finishedLoading
      );

    bufferLoader.load();
  }

  function finishedLoading(bufferList) {
    for (var key in bufferList) {
      buffers[key] = bufferList[key];
    }
  }
</script>